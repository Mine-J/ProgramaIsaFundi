name: Reservas Deportes

on:
  
  # schedule:
  #   # Lunes
  #   - cron: "45 12 * * 6"  # 16:30 Madrid 13:30 UTC
  #   - cron: "45 13 * * 6"  # 17:30 Madrid -45min â†’ 14:45 UTC
  #   - cron: "45 14 * * 6"  # 18:30 Madrid -45min â†’ 15:45 UTC
  #   # Martes
  #   - cron: "0 12 * * 0"   # 15:45 Madrid -45min â†’ 13:00 UTC
  #   - cron: "45 13 * * 0"  # 17:30 Madrid -45min â†’ 14:45 UTC
  #   # MiÃ©rcoles
  #   - cron: "45 12 * * 1"  # 16:30 Madrid -45min â†’ 13:45 UTC
  #   - cron: "45 13 * * 1"  # 17:30 Madrid -45min â†’ 14:45 UTC
  #   - cron: "45 14 * * 1"  # 18:30 Madrid -45min â†’ 15:45 UTC
  #   # Jueves
  #   - cron: "0 12 * * 2"   # 15:45 Madrid -45min â†’ 13:00 UTC
  #   - cron: "45 13 * * 2"  # 17:30 Madrid -45min â†’ 14:45 UTC
  #   # Viernes
  #   - cron: "45 11 * * 3"  # 15:30 Madrid -45min â†’ 12:45 UTC
  #   - cron: "45 12 * * 3"  # 16:30 Madrid -45min â†’ 13:45 UTC

  schedule:
  # Lunes
  - cron: "20 13 * * 6"   # Clase 15:45 Madrid â†’ Ejecuta 1h45 antes (14:00 UTC)
  - cron: "35 14 * * 6"  # Clase 17:00 Madrid â†’ Ejecuta 1h45 antes (15:15 UTC)
  - cron: "35 15 * * 6"  # Clase 18:00 Madrid â†’ Ejecuta 1h45 antes (16:15 UTC)

  # Martes
  - cron: "20 13 * * 0"   # Clase 15:45 Madrid â†’ Ejecuta 1h45 antes (13:00 UTC)
  - cron: "35 14 * * 0"  # Clase 17:00 Madrid â†’ Ejecuta 1h45 antes (15:15 UTC)
  - cron: "35 15 * * 0"  # Clase 18:00 Madrid â†’ Ejecuta 1h45 antes (16:15 UTC)

  # MiÃ©rcoles
  - cron: "35 15 * * 1"  # Clase 18:00 Madrid â†’ Ejecuta 1h45 antes (16:15 UTC)
  - cron: "35 16 * * 1"  # Clase 19:00 Madrid â†’ Ejecuta 1h45 antes (17:15 UTC)

  # Jueves
  - cron: "20 13 * * 2"   # Clase 15:45 Madrid â†’ Ejecuta 1h45 antes (13:00 UTC)
  - cron: "35 14 * * 2"  # Clase 17:00 Madrid â†’ Ejecuta 1h45 antes (15:15 UTC)

  # Viernes
  - cron: "05 13 * * 3"  # Clase 15:30 Madrid â†’ Ejecuta 1h45 antes (12:45 UTC)
  - cron: "05 14 * * 3"  # Clase 16:30 Madrid â†’ Ejecuta 1h45 antes (13:45 UTC)





  # Permite lanzarlo manualmente desde GitHub (Actions â†’ Run workflow)
  workflow_dispatch:

jobs:
  run-script:
    runs-on: ubuntu-latest
    env:
      TZ: Europe/Madrid # ðŸ”¹ Fuerza la zona horaria a Madrid
      MONGO_URL: ${{ secrets.MONGO_URL }}
      EMAIL: ${{ secrets.EMAIL }}
      PASSWORD: ${{ secrets.PASSWORD }}

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.11"

      - name: Install dependencies
        run: |
          pip install -r requirements.txt
          playwright install chromium

      - name: Debug env
        run: |
          echo "EMAIL length: ${#EMAIL}"
          echo "PASSWORD length: ${#PASSWORD}"
          echo "MONGO_URL length: ${#MONGO_URL}"

      - name: Run script
        run: python ProgramaFundi.py
